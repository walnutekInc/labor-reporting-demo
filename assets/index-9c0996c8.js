import{D as T,x as b,b as $,d as x,e,j as D,t as C,G as S,H as V,f as m,U as B,z as E,w as y,I as A,V as I,W as q,T as F,g as r,A as R,c as U,E as M,J as N,k as z,X as P,O as L,B as j,P as O,Q as K,F as G}from"./index-d757128d.js";import{_ as H,D as J,a as Q,S as v}from"./sweetalert2.all-ef22fbbf.js";import{u as W,b as X,a as Y,c as g,_ as w}from"./object-ac06494d.js";import{s as Z}from"./default.cssvuetypestyleindex0srctruelang-cb4dc70d.js";import{_ as ee}from"./plugin-vueexport-helper-c27b6911.js";import"./menu-02b7f324.js";const te={class:"mg-b-10"},se={class:"text-danger"},oe={class:"invalid-feedback"},ae={__name:"FormSelect",props:{name:{type:String,required:!0},value:{type:[String,Number,Array]},label:{type:String,required:!0},required:{type:Boolean,default:!1}},setup(p){const _=p,c=T(_,"name"),{value:i,errorMessage:n,handleBlur:f,handleChange:l}=W(c,void 0,{..._.value&&{initialValue:_.value}}),u=b(null);return(d,h)=>($(),x("div",{class:R(["form-group",{"has-error":!!r(n)}])},[e("p",te,[D(C(p.label)+" ",1),S(e("span",se,"*",512),[[V,p.required]])]),m(r(Z),F({ref_key:"multiSelectRef",ref:u},d.$attrs,{value:r(i),onChange:r(l),onBlur:r(f)}),B({_:2},[E(Object.keys(d.$slots),a=>({name:a,fn:y(s=>[A(d.$slots,a,I(q(s||{})),void 0,!0)])}))]),1040,["value","onChange","onBlur"]),e("div",oe,C(r(n)),1)],2))}},ne=ee(ae,[["__scopeId","data-v-6890ca91"]]),re={class:"col-12 col-lg-6"},le={class:"col-12 col-lg-6"},ce={class:"col-12 col-lg-6"},ie={class:"col-12 col-lg-6"},ue={class:"btn-list text-center mt-5"},de=e("button",{class:"btn btn-md btn-primary",type:"submit"}," 確定 ",-1),me={__name:"FormModal",props:{reload:{type:Function,required:!0}},setup(p,{expose:_}){const c=p,i=b(!1),{handleSubmit:n,resetForm:f}=X({initialValues:{name:"",account:"",password:"",status:"ACTIVED"},validationSchema:U(()=>Y().shape({name:g().required("姓名是必填的"),account:g().required("帳號是必填的"),password:g().test("notEdit","密碼是必填的",function(a){return i.value?!0:!M(a)})}))}),l=N(),u=b(null),d=(a=null)=>{i.value=a!==null,f({values:a?{...a,password:""}:{name:"",account:"",password:"",status:"ACTIVED"}}),u.value.show()},h=n(async a=>{console.log("Form submitted:",a),u.value.hide(),l.success("成功"),c.reload(),u.value.hide()});return _({show:d}),(a,s)=>($(),z(H,{ref_key:"modalRef",ref:u,title:i.value?"編輯用戶":"新增用戶","dialog-class":"modal-dailog-centered","hide-footer":!0},{default:y(()=>[e("form",{class:"row",onSubmit:s[1]||(s[1]=(...t)=>r(h)&&r(h)(...t))},[e("div",re,[m(w,{name:"name",label:"姓名",required:""})]),e("div",le,[m(w,{name:"account",label:"帳號",required:""})]),e("div",ce,[m(w,{name:"password",label:"密碼",required:!i.value},null,8,["required"])]),e("div",ie,[m(ne,{name:"status",label:"狀態","can-clear":!1,options:[{label:"啟用",value:"ACTIVED"},{label:"停用",value:"停用"}]})]),e("div",ue,[e("button",{class:"btn btn-md btn-outline-primary",type:"button",onClick:s[0]||(s[0]=t=>u.value.hide())}," 取消 "),de])],32)]),_:1},8,["title"]))}},_e={class:"row row-sm"},pe={class:"col-sm-12 col-md-12 col-lg-12 col-xl-12 grid-margin"},fe={class:"card custom-card"},he={class:"card-header border-bottom-0 pb-0"},ve={class:"row"},be={class:"col-12"},ye={class:"d-flex flex-column flex-lg-row justify-content-between"},ge={class:"input-group wd-lg-25p"},we={class:"input-group-append"},Ce={class:"card-body"},$e={class:"form-check form-switch"},ke=["id","checked","onChange"],xe=["for"],Se={class:"d-flex"},Te=["onClick"],De=["onClick"],Ve="帳號管理",Re={__name:"index",setup(p){const{getUserList:_,pagination:c,userList:i}=P(),n=L({keyword:"",sort:"desc",orderBy:"createDate"});j(()=>{l(1)});const f=[{key:"name",label:"姓名",sort:!0},{key:"account",label:"帳號"},{key:"status",label:"狀態"},{key:"action",label:"Action"}],l=async(s=1,t=10)=>{let o={page:s,limit:t,...n};await _(o)},u=(s="createTime",t="desc")=>{n.orderBy=s,n.sort=t,l(1,c.value.size)},d=b(null),h=s=>{v.fire({title:"Are you sure?",text:`刪除 User「${s.name}」？`,type:"warning",showCancelButton:!0,confirmButtonText:"是的，確定刪除"}).then(async t=>{t.value&&(await l(i.value.length==1?1:c.value.current),v.fire("This Deleted!",`刪除 User「${s.name}」！`,"success"))})},a=async s=>{try{const t=s.status==="ACTIVED"?"UNACTIVED":"ACTIVED";s.status=t,v.fire({title:"狀態更新成功",text:`用户 "${s.name}" 的狀態已更改為 ${t==="ACTIVED"?"啟用":"停用"}`,icon:"success",confirmButtonText:"確定"})}catch(t){console.error("更新用户状态失败:",t),v.fire({title:"更新失敗",text:"無法更新用户狀態，請稍後再試。",icon:"error",confirmButtonText:"確定"}),s.status=s.status==="ACTIVED"?"UNACTIVED":"ACTIVED"}};return(s,t)=>($(),x(G,null,[m(Q,{title:Ve}),e("div",_e,[e("div",pe,[e("div",fe,[e("div",he,[e("div",ve,[e("div",be,[e("div",ye,[e("div",ge,[S(e("input",{type:"text",class:"form-control",placeholder:"搜尋","onUpdate:modelValue":t[0]||(t[0]=o=>n.keyword=o),onKeyup:t[1]||(t[1]=K(o=>l(1),["enter"]))},null,544),[[O,n.keyword]]),e("span",we,[e("button",{class:"btn btn-primary",type:"button",onClick:t[2]||(t[2]=o=>l(1))}," 搜尋 ")])]),e("button",{class:"btn btn-primary mt-2 mt-lg-0",onClick:t[3]||(t[3]=o=>d.value.show())},"新增帳號")])])])]),e("div",Ce,[m(J,{header:f,items:r(i),onChangePage:l,onOrderChange:u,pagination:r(c),orderBy:n.orderBy,sort:n.sort},{status:y(({item:o})=>[e("div",$e,[e("input",{class:"form-check-input",type:"checkbox",id:`statusSwitch_${o.account}`,checked:o.status==="ACTIVED",onChange:k=>a(o)},null,40,ke),e("label",{class:"form-check-label",for:`statusSwitch_${o.account}`},C(o.status==="ACTIVED"?"啟用":"停用"),9,xe)])]),action:y(({item:o})=>[e("div",Se,[e("button",{class:"btn btn-sm btn-danger me-2",type:"button",onClick:k=>h(o)},"刪除",8,Te),e("button",{class:"btn btn-sm btn-info me-2",type:"button",onClick:k=>d.value.show(o)},"修改",8,De)])]),_:1},8,["items","pagination","orderBy","sort"])])])]),m(me,{ref_key:"formModalRef",ref:d,reload:()=>l(r(c).current,r(c).size)},null,8,["reload"])])],64))}};export{Re as default};
